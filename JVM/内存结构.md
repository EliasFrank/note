1. 程序计数器

    1. 定义

        Program Counter Register 程序计数器（寄存器）

    2. 作用

        记住下一条jvm指令的执行地址

        <img src="H:\Notes\JVM\upload\image-20210318144816818.png" alt="image-20210318144816818" style="zoom: 25%;" />

    3. 特点

        * 线程私有
        * 不会存在内存溢出

2. 虚拟机栈

    1. 定义

        java virtual machine statcks （java虚拟机栈）

        * 每个线程运行时所需要的内存，称为虚拟机栈
        * 每个栈由多个栈帧（frame）组成，对应着每次方法调用时所占的内存
        * 每个线程只能有一个活动栈帧，对应着当前正在执行的那个方法

        问题辨析：

        1. 垃圾回收是否涉及栈内存？

            不涉及，栈帧只要调用后就会弹出

        2. 栈内存分配越大越好吗？

            不是，内存分配越大，可分配的线程就越少（-Xss1m）

        3. 方法内的局部变量是否线程安全的

            * 如果方法内局部变量没有逃离方法的作用范围，他就是线程安全的
            * 如果是局部变量引用了对象，并逃离方法的作用方法，需要考虑线程安全

    2. 栈内存溢出

        * 栈帧过多导致栈内存溢出
        * 栈帧过大导致栈内存溢出

    3. 线程运行诊断

        1. cpu占用过多

            定位：

            1. 用top定位哪个进程对cpu的占用过高
            2. ps H -eo pid, tid, %cpu | grep 进程id（用ps命令进一步定位是哪个线程引起的cpu占用过高）
            3. jstack 进程id
                * 可以根据线程id找到有问题的线程，进一步定位到问题代码的源码行号

        2. 程序运行很长时间没有结果

3. 本地方法栈

4. 堆 heap

    1. 定义
        * 通过new关键字，创建对象都会使用堆内存

    2. 特点： 

        * 他是线程共享的，堆中对象都需要考虑线程安全的问题

        * 有垃圾回收机制

    3. 堆内存溢出

        可以将堆内存设置的小一点，以便快速的发现问题

    4. 堆内存诊断

        1. jps

            查看当前系统中有哪些java进程

        2. jmap

            查看堆内存占用情况（jhsdb jmap --heap --pid 进程id）

        3. jconsole

            图形界面的，多功能的监测工具，可以连续监测 

5. 方法区