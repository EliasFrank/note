###  三级模式

#### 两级映射

![1602747051635](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1602747051635.png)

### 数据库的设计过程

![1602747963245](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1602747963245.png)

###  E-R模型

![1602748466398](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1602748466398.png)

**集成的方法：**

* 多个局部E-R图一次集成
* 逐步集成，用累加的方式一次集成两个局部E-R

**集成产生的冲突及解决办法**

* 属性名冲突：包括属性域冲突和属性值冲突
* 命名冲突：包括同名异义和异名同义
* 结构冲突：包括同义对象在不同应用中具有不同的抽象，以及同一实体在不同局部E-R图中所包含的属性个数和属性排列次序不完全相同

### 关系代数

并、交、差、笛卡尔积、投影、选择、联接

### 规范化理论

#### 函数依赖

设R(U)是属性U上的一个关系模式，X和Y是U的子集，r为R的任一关系，如果对于r中的任一两个元组u,v，只要有u[X]=v[X]，就有u[Y]=v[Y]，则称X函数决定Y，或称Y函数依赖于X，记为X->Y

![1602751419253](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1602751419253.png)

![1602751428080](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1602751428080.png)

#### 键

![1602838503532](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1602838503532.png)

#### 求候选键

* 将关系模式的函数依赖关系用“有向图”的方式表示
* 找入度为0的属性，并以该属性集合为起点，尝试遍历有向图，若能正常遍历图中所有结点，则该属性集即为关系模式的候选键
* 若入度为0的属性集不能遍历图中所有结点，则需要尝试性的将一些中间结点（既有入度，也有出度的节点）并入入度为0的属性集中，直至该集合能遍历所有结点，集合为候选键。

#### 范式

![1602846698154](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1602846698154.png)

#### 模式分析

![1603069847856](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1603069847856.png)

#### 模式分解

![1603070495456](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1603070495456.png)

### 并发控制

#### 基本概念

![1603070666854](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1603070666854.png)

![1603070842411](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1603070842411.png)

#### 封锁协议

* 一级封锁协议。事务T在修改数据R之前必须先对其加X锁，知道事务结束才释放。可防止丢失修改
* 二级封锁协议。一级封锁协议加上事务T在读取数据R之前先对其加S锁，读完后即可释放S锁，防止丢失修改，还可防止读“脏”数据
* 三级封锁协议。一级封锁协议加上事务T在读取数据R之前对其加S锁，知道事务结束才释放。可防止丢失修改、防止脏读、防止数据重复度
* 两段锁协议。可串行化的。可能发生死锁

### 数据库完整性约束

1. 实体完整性约束
2. 参照完整性约束
3. 用户自定义完整性约束
4. 触发器

### 数据库安全

|      措施      |                             说明                             |
| :------------: | :----------------------------------------------------------: |
| 用户标识和鉴定 | 最外层的安全保护措施，可以使用用户账户、口令及随机数检验等方式 |
|    存取控制    |     对用户进行授权，包括操作类型（CRUD）和数据对象的权限     |
| 密码存储和传输 |                   对远程终端信息用密码传输                   |
|   视图的保护   |                        对视图进行授权                        |
|      审计      | 使用一个专用文件或数据库，自动将用户对数据库的所有操作记录下俩 |

### 数据备份

* 冷备份也称为静态备份，是将数据库正常关闭，在停止状态下，将数据库的文件全部备份（复制）下来
* 热备份也称为动态备份，是利用备份软件，在数据库正常运行的状态下，将和数据库中的数据文件备份出来



| 备份方式、优缺点 | 优点                                                         | 缺点                                                         |
| ---------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 冷备份           | 非常快速的备份方法（只需复制文件）；容易归档（简单复制即可）；容易恢复到某个时间点上（只需将文件再复制回去）；能与归档方法相结合，做数据库“最佳状态”的恢复；低度维护，高度安全 | 单独使用时，只能提供到某一时间点上的恢复；在实施备份的全过程中，数据库必须要作备份而不能做其他工作；若磁盘空间有限，只能复制到磁带等其他外部储存设备上，速度会很慢，不能按表或按用户恢复 |
| 热备份           | 可在表空间或数据库文件级备份，备份的时间短；备份时数据库仍可使用；可达到秒级恢复（恢复到某一时间点上）；可对几乎所有数据库实体做恢复；恢复是快速的 | 不能出错，否则后果很严重；若热备份不成功所得结果不可用于时间点的恢复；困难与维护，所以要特别小心，不允许“以失败告终” |

* 完全备份：备份所有数据
* 差量备份：仅备份上一次完全备份之后变化的数据
* 增量备份：备份上一次备份之后变化的数据



1. 静态海量转储：在系统无运行事务时进行，每次转储全部数据库
2. 静态增量转储：在系统无运行事务时进行，每次只转储上一次转储后更新过的数据
3. 动态海量转储：转储期间允许对数据库进行存取或修改，每次转储全部数据库
4. 动态增量转储：转储期间允许对数据库进行存取或修改，每次只转储上一次转储后更新过的数据



* 日志文件：事务日志是真谷底数据库改变所做的记录，他可以记录针对数据库的任何操作，并将记录结果保存在独立的文件中

### 数据库故障与恢复

|        故障关系        |        故障原因        |                           解决方法                           |
| :--------------------: | :--------------------: | :----------------------------------------------------------: |
|  事务本身的可预期故障  |        本身逻辑        |                 在程序中预先设置rollback语句                 |
| 事务本身的不可预期故障 | 算术溢出、违反存储保护 | 由DBMS的恢复子系统通过日志，撤销事务对数据库的修改，回退到事务初始状态 |
|        系统故障        |      系统停止运转      |                       通常使用检查点法                       |
|        介质故障        |       外存被破坏       |                     一般使用日志重做业务                     |

### 数据仓库与数据挖掘

![1603176801397](C:\Users\hl2333\AppData\Roaming\Typora\typora-user-images\1603176801397.png)

* 面向主题
* 集成的
* 相对稳定的（非易失的）
* 反映历史变化（随着时间变化）

### 数据挖掘方法分类

方法：

1. 决策树
2. 神经网络
3. 遗传算法
4. 关联规则挖掘算法

分类：

1. 关联分析：挖掘出隐藏在数据间的相互关系
2. 序列模式分析：侧重点是分析数据间的前后关系（因果关系）
3. 分类分析：为每一个记录赋予一个标记再按标记分类
4. 聚类分析：分类分析法的逆过程

### 反规范化

由于规范化会使表不断的才分，从而导致数据表过多。这样虽然减少了数据冗余，提高了增删改的速度，但会增加查询的工作量。系统需要进行多次连接，才能进行查询操作，使得系统效率大大下降

技术手段

* 增加派生性冗余列
* 增加冗余列
* 重新组表
* 分割表

### 大数据

4V ： 

数据量：Volume

速度：Velocity

多样性：Variety

值：Value

|   比较维度   |       传统数据       |             大数据             |
| :----------: | :------------------: | :----------------------------: |
|    数据量    |       GB或TB级       |           PB级或以上           |
| 数据分析需求 | 现有的数据分析与检测 | 深度分析（关联分析、回归分析） |
|   硬件平台   |      高端服务器      |            集群平台            |

大数据处理系统应该具有的重要特征

* 高度可扩展性
* 高性能
* 高度容错
* 支持异构华景
* 较短的分析延迟
* 易用且开放的接口
* 较低成本
* 向下兼容性

